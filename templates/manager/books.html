{% load static %}
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="{% static 'css/Mmembers.css' %}">

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<!-- Sidebar -->
<div class="container-fluid fixed-top col py-5">
  <div class="row flex-nowrap">
      <div class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark">
          <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-5 text-white min-vh-100">
              <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
                  <h4>
                    <li class="nav-item">
                      <a href="/manager/dashboard" class="nav-link align-middle px-0">
                          <i class="fs-4 bi-house"></i> <span class="ms-1 d-none d-sm-inline">Dashboard</span>
                      </a>
                  </li>
                  <li>
                      <a href="#" class="nav-link px-0 align-middle">
                          <i class="fs-4 bi-table"></i> <span class="ms-1 d-none d-sm-inline">Transactoins</span></a>
                  </li>
                  <li>
                      <a href="#" class="nav-link px-0 align-middle">
                          <i class="fs-4 bi-people"></i> <span class="ms-1 d-none d-sm-inline">Members</span> </a>
                  </li>
                  <li>
                    <a href="#" class="nav-link px-0 align-middle">
                        <i class="fs-4 bi-people"></i> <span class="ms-1 d-none d-sm-inline">Books</span> </a>
                  </li>
                  <li>
                    <a href="#" class="nav-link px-0 align-middle">
                        <i class="fs-4 bi-people"></i> <span class="ms-1 d-none d-sm-inline">Settings</span> </a>
                  </li>
                </h4>
              </ul>
              <hr>
          </div>
      </div>
<!-- Sidebar -->

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <div class="container-fluid">
        <li style="list-style: none;">Library Name</li>
        <li class="nav-item dropdown" dropdown style="list-style: none;">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Welcome Mr.{{admin.name}}
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a href="" class="dropdown-item">Edit profile</a>
                <a href="/manager/adminlogout" class="dropdown-item">Logout</a>
            </div>
        </li>
    </div>
  </nav>
<!-- Navbar close-->



<!-- <button class="btn btn-success btn-lg float-right" type="submit">Submit</button> align button right -->
<br>
  <!--Books Table-->
  <div class="container col py-5" >
      <!-- <div class="card-body  container-fluid mb-2"> -->
        <!-- Add Book Button -->
        <a href="" class="btn btn-danger float-right mb-3" data-toggle="modal" data-target="#modalLoginForm">Add New Book+</a>
      <!-- </div> -->
      <h5 class="card-title text-uppercase mb-0">Books</h5>
      <!-- search bar -->
      <div class="input-group">
        <input type="search" class="form-control rounded" placeholder="Search By: Book Name/Author" aria-label="Search" aria-describedby="search-addon" />
        <button type="button" class="btn btn-outline-primary">Search</button>
      </div>
  <div class="row">
      <div class="col-md-12">
          <div class="card">
              <div class="table-responsive">
                  <table class="table no-wrap user-table mb-0">
                    <thead>
                      <tr>
                        <th scope="col" class="border-0 text-uppercase font-medium pl-4">#</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Book Id</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Book Name</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Author</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Purchase Date</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Current Status</th>
                        <th scope="col" class="border-0 text-uppercase font-medium">Actions</th>
                        <!-- <th scope="col" class="border-0 text-uppercase font-medium">Manage</th> -->
                      </tr>
                    </thead>
                    <tbody>
                        {% for book in books %}
                          <tr>
                            <td class="pl-4">{{ forloop.counter }}</td>
                            <td>

                                <h5 class="font-medium mb-0">{{book.id}}</h5>
                            </td>
                            <td>
                                <span class="text-muted">{{book.title}}</span><br>
                            </td>
                            <td>
                                <span class="text-muted">{{book.author}}</span><br>
                            </td>
                            <td>
                              <span class="text-muted">{{book.created_at}}</span><br>
                            </td>
                            
                            <td>
                              <span class="text-muted">{{book.current_status}}</span><br>
                            </td>
                            <td>
                              <a href="">View</a>&nbsp;
                              <a href="">Edit</a>&nbsp;
                              <a href="" class="building-link" data-toggle="modal" data-target="#deleteBookForm" data-title="{{book.title}}" data-bookid="{{book.id}}">Delete</a>&nbsp;
                            </td>
                          </tr>
                        {% endfor %}
                    </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
  </div>
  <!--Books Table Close-->
</div>
</div>

<!-- Add Books Popup-->
<div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Add New Book</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form class="form-horizontal" enctype="multipart/form-data" id="addbook" method="post">
        <div class="modal-body mx-3">
          <div class="md-form mb-4">
            <!-- <i class="fas fa-lock prefix grey-text"></i> -->
            <label data-error="wrong" data-success="right" for="defaultForm-pass">Title</label>
            {{form.title}}<br>
            <label data-error="wrong" data-success="right" for="defaultForm-pass">Author</label>
            {{form.author}}<br>            
            <label data-error="wrong" data-success="right" for="defaultForm-pass">Language</label>
            {{form.language}}<br>            
            <label data-error="wrong" data-success="right" for="defaultForm-pass">Image</label>
            {{form.image}}<br>
          </div>
        </div>
        <div class="modal-footer d-flex justify-content-center">
          <button class="btn btn-primary" type="submit">Add</button>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- Add Books Popup Close-->

<!-- Delete Book PopUp -->
<div class="modal fade" id="deleteBookForm" tabindex="-1" role="dialog" aria-labelledby="deleteBookLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <p>Are you sure you want to delete <h7 class="modal-title" id="building-name"></h7>?</p>
          <form action="/manager/deleteBook/" method="POST">
              {% csrf_token %}
              <input type="hidden" name="book_id" id="bk_id" value="">
              <a href="">Cancel</a>&nbsp;
              <input type="submit" value="Confirm">
          </form>
      </div>
    </div>
  </div>
</div>
<!-- Delete Book PopUp Close-->

<script>
  if ( window.history.replaceState ) {
  window.history.replaceState( null, null, window.location.href );
}
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js">

  $('#deleteBookForm').on('show.bs.modal', function (event) {
  var link = $(event.relatedTarget)
  var book_id = link.data('bookid')
  var book_name = link.data('titile')
  var modal = $(this)
  modal.find('.modal-body #book_id').val(book_id);
  })
</script>